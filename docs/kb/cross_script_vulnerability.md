# Prevent Cross Script (XSS) vulnerability 

1. [Escape assigned variable on templates](#escape-assigned-variable-on-templates)
2. [None secure svg files](#none-secure-svg-files)

## Escape assigned variable on templates

For instance, you have a comment form on your shop with the form field content.
Your module saves the content in a database.

Someone can send this content :

> ```
> I love this product <script> alert(document.URL); </script>
> ```

If in your backoffice you display in a template :

> ***DON'T DO:***
> ```
> {$comment.content}
> ```

Your browser will evaluate the javascript. A hacker can steal the backoffice URL, your backoffice session.

To protect your form with smarty :

> ***DO:***
> ```
> <p>{$comment.content|escape:htmlall:'UTF-8'}</p>
> <p>{$comment.content|strip_tags}</p>
> ```

In a twig template :

> ***DO:***
> ```
> <p>{{ comment.content|e }}</p>
> ```

Escape filter a twig or smarty assignment will apply php method htmlentities(). In this case, html source will be display in source code as :

> ```
I love this product &lt;script&gt; alert(document.URL); &lt;/script&gt;
> ```

And your browser will show html tags.

Please note that:
- *urlencode()* or *addslashes()* could be not efficient to prevent against XSS vulnerability at all time.
- *striptags()* or *htmlentities()* before saving data in the database could also be a good idea !

## None secure svg files

SVG files can contain javascript that can be executed if you load with your browser the SVG. 

## a faire

[![go left](/images/resized/left-arrow-9133251.png)](/security-advisories/kb/php_injections.html) | [Prevent PHP injections](/php_injections.md) | [![go back](/images/resized/back-to-menu-arrow-9121722.png)](/security-advisories/kb/index.html) | [![go up](/images/resized/up-arrow-1767592-1502496.png)](#prevent-sensitive-data-disclosure) | [Prevent Cross Script (XSS) vulnerability](/cross_script_vulnerability.md) | [![go right](/images/resized/right-arrow.png)](/security-advisories/kb/cross_script_vulnerability.html)