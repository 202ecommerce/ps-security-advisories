---
layout: default
title: 202ecommerce Security Advisories
---

# Prevent Cross Script (XSS) vulnerability 

  - [Escape assigned variable on templates](#escape-assigned-variable-on-templates)
  - [None secure svg files](#none-secure-svg-files)

## Escape assigned variable on templates

For instance, you have a comment form on your shop with the form field content.
Your module saves the content in a database.

Someone can send this content :

> ```html
> I love this product <script> alert(document.URL); </script>
> ```

If in your backoffice you display in a template :

> ***DON'T DO:***
> ```html
> {$comment.content}
> ```

Your browser will evaluate the javascript. A hacker can steal the backoffice URL, your backoffice session.

To protect your form with smarty :

> ***DO:***
> ```html
> <p>{$comment.content|escape:htmlall:'UTF-8'}</p>
> <p>{$comment.content|strip_tags}</p>
> ```

In a twig template :

> ***DO:***
> ```html
> {% raw %}
> <p>{{$comment.content|e}}</p>
> {% endraw %}
> ```

Escape filter a twig or smarty assignment will apply php method htmlentities(). In this case, html source will be display in source code as :

> ```
> I love this product &lt;script&gt; alert(document.URL); &lt;/script&gt;
> ```

And your browser will show html tags.

Please note that:
- *urlencode()* or *addslashes()* could be not efficient to prevent against XSS vulnerability at all time.
- *striptags()* or *htmlentities()* before saving data in the database could also be a good idea !

## None secure svg files

SVG files can contain javascript that can be executed if you load with your browser the SVG. 

<br>

****

<br>

[![go left](/images/left-arrow-9133251.png)](/security-advisories/kb/sensitive_data_disclosure.html) | [Prevent sensitive data disclosure](/sensitive_data_disclosure.md) | [![go back](/images/back-to-menu-arrow-9121722.png)](/security-advisories/kb/index.html) | [![go up](/images/up-arrow-1767592-1502496.png)](#prevent-cross-script-xss-vulnerability) | [Prevent logical weakness](/logical_weakness.md) | [![go right](/images/right-arrow.png)](/security-advisories/kb/logical_weakness.html)